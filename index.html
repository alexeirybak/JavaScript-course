<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Image Loader</title>
  </head>
  <style>
    #loader {
      display: none; /* По умолчанию лоадер скрыт */
    }
  </style>
  <body>
    <button id="button">Загрузить изображение</button>
    <div id="imageContainer"></div>
    <img id="loader" src="loader.gif" alt="Loading..." />

    <script>
      const btn = document.getElementById("button");
      const imageContainer = document.getElementById("imageContainer");
      const loader = document.getElementById("loader");

      btn.addEventListener("click", fn);

      function fn() {
        // Показываем лоадер перед началом загрузки
        loader.style.display = "block";

        // Функция для загрузки изображения
        function loadImage(url) {
          return new Promise((resolve, reject) => {
            const image = new Image(); // Создаем новый объект изображения

            // Обработчик загрузки изображения
            image.onload = () => {
              resolve(image); // Изображение успешно загружено
            };

            // Обработчик ошибки загрузки
            image.onerror = () => {
              reject(new Error(`Не удалось загрузить изображение`));
            };

            // Устанавливаем URL изображения
            image.src = url;
          });
        }

        // Загружаем изображение
        loadImage(
          "https://kot-prikol.ru/uploads/posts/2024-11/1732874017_1.jpg"
        )
          .then((image) => {
            console.log("Изображение загружено");
            imageContainer.append(image); // Добавляем изображение в контейнер
          })
          .catch((error) => {
            console.error("Ошибка:", error.message);
          })
          .finally(() => {
            console.log("Запрос завершен");
            loader.style.display = "none"; // Скрываем лоадер после завершения
          });
      }
    </script>
  </body>
</html>
